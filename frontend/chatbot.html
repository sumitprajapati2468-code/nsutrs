<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Rider Saathi AI Chat Bot</title>
    <link rel="icon" href="/src/assets/Rider-saathi-logo.jpeg" />
    <style>
      :root{
        --bg:#0a0a0b; --card:#0f1113; --muted:#9ca3af; --neon-cyan:#00f0ff; --neon-purple:#bf00ff;
      }
      html,body{height:100%;margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial}
      body{background:linear-gradient(180deg,#050506 0%, #0a0a0b 100%);color:#fff;display:flex;align-items:center;justify-content:center;padding:24px}
      .chatbot-section{width:100%;max-width:880px}
      h1{font-family:Orbitron,Inter,Arial;font-size:22px;margin:0 0 18px;color:var(--neon-cyan)}
      .chat-container{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.04);padding:18px;border-radius:12px}
      #chat-window{height:420px;overflow:auto;padding:12px;background:linear-gradient(180deg, rgba(0,0,0,0.25), transparent);border-radius:8px;border:1px solid rgba(255,255,255,0.02)}
      .chat-input{display:flex;gap:8px;margin-top:12px}
      .chat-input input{flex:1;padding:12px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:#0b0b0c;color:#fff}
      .chat-input button{padding:12px 16px;border-radius:8px;border:none;background:linear-gradient(90deg,var(--neon-cyan),var(--neon-purple));color:#0b0b0c;font-weight:600;cursor:pointer}
      .user-msg,.bot-msg{margin:8px 0;padding:10px 12px;border-radius:10px;max-width:85%}
      .user-msg{background:linear-gradient(90deg, rgba(0,240,255,0.08), rgba(191,0,255,0.06));align-self:flex-end;margin-left:auto}
      .bot-msg{background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.02)}
      .controls{display:flex;justify-content:space-between;align-items:center;margin-top:10px}
      .back-home{display:inline-block;color:var(--muted);text-decoration:none;font-size:14px}
      .meta{font-size:13px;color:var(--muted)}
    </style>
  </head>
  <body>
    <section class="chatbot-section">
      <div class="controls">
        <h1>Rider Saathi AI Chat Bot</h1>
        <a class="back-home" href="index.html">← Back to Home</a>
      </div>

      <div class="chat-container">
        <div id="chat-window" aria-live="polite"></div>

        <div class="chat-input">
          <input id="userInput" type="text" placeholder="Ask me anything about Rider Saathi..." />
          <button id="sendBtn">Send</button>
        </div>

        <div style="margin-top:8px;display:flex;justify-content:space-between;align-items:center">
          <div class="meta">Responses powered by OpenAI GPT</div>
          <div class="meta">Replace the API key in the script before use</div>
        </div>
      </div>
    </section>

    <script>
  // NOTE: For security do NOT store real API keys in client-side JS for production.
  // This demo will prompt you to paste a key into the browser (kept only in sessionStorage)
  // so you can test without editing the file. For production, proxy requests via your backend.
  let API_KEY = sessionStorage.getItem('OPENAI_KEY') || null;

      function appendMessage(content, cls) {
        const chatWindow = document.getElementById('chat-window');
        const el = document.createElement('div');
        el.className = cls;
        el.textContent = content;
        chatWindow.appendChild(el);
        chatWindow.scrollTop = chatWindow.scrollHeight;
      }

      async function sendMessage() {
        const userInputEl = document.getElementById('userInput');
        const userInput = userInputEl.value.trim();
        if (!userInput) return;
        appendMessage(userInput, 'user-msg');
        userInputEl.value = '';

        appendMessage('…thinking', 'bot-msg');
        const botPlaceholder = document.getElementById('chat-window').lastElementChild;

        // If no key in sessionStorage, prompt the user to paste one (kept only for this session)
        if (!API_KEY) {
          const pasted = window.prompt('Paste your OpenAI API key (will be stored in this browser session only)')
          if (!pasted) {
            botPlaceholder.textContent = 'No API key provided. Please refresh and paste the key when prompted.';
            return;
          }
          API_KEY = pasted.trim();
          sessionStorage.setItem('OPENAI_KEY', API_KEY);
        }

        try {
          const res = await fetch('https://api.openai.com/v1/chat/completions', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              'Authorization': `Bearer ${API_KEY}`
            },
            body: JSON.stringify({
              model: 'gpt-3.5-turbo',
              messages: [{ role: 'user', content: userInput }],
              max_tokens: 400
            })
          });

          if (!res.ok) {
            const errText = await res.text();
            botPlaceholder.textContent = 'Error: ' + errText;
            return;
          }

          const data = await res.json();
          const reply = data?.choices?.[0]?.message?.content || 'No reply';
          botPlaceholder.textContent = reply;
        } catch (err) {
          console.error(err);
          botPlaceholder.textContent = 'Failed to fetch reply. See console for details.';
        }
      }

      document.getElementById('sendBtn').addEventListener('click', sendMessage);
      document.getElementById('userInput').addEventListener('keydown', (e) => {
        if (e.key === 'Enter') sendMessage();
      });
    </script>
  </body>
</html>
